!function(e,t){"use strict";if("querySelectorAll"in t){"AG"in e||(e.AG={}),e.location.origin||(e.location.origin=e.location.protocol+"//"+e.location.host);var n,o,i=t.querySelectorAll(".webmentions__list"),l={a:t.createElement("a"),author_name:t.createElement("b"),article:t.createElement("article"),div:t.createElement("div"),photo:t.createElement("img"),li:t.createElement("li"),time:t.createElement("time")},a=t.createTextNode(" "),r=["January","February","March","April","May","June","July","August","September","October","November","December"],c=[],s=!1,d=t.querySelector('meta[property="webmention:redirected_from"]'),p=[],u=e.location.origin,m=[],h=0;if(d&&(d.getAttribute("content").split(",").forEach(function(e){c.push(e.indexOf("//")<0?u+e:e)}),!1),"http:"!=e.location.protocol&&(c.forEach(function(e){p.push(e),-1!=e.indexOf("https://")&&p.push(e.replace("https://","http://"))}),c=p,p=!1),i.length<1){if(!(s=t.querySelectorAll(".webmentions__not-found")).length)return;s=s[0],(i=t.createElement("ol")).className="webmentions__list"}else{for(h=(o=(i=i[0]).querySelectorAll("[id^=webmention-]")).length;h--;)m.push(o[h].getAttribute("id").replace("webmention-",""));o=null}if(e.AG.existing_webmentions=m,l.li.className="webmentions__item",l.article.className="h-cite webmention",l.time.className="webmention__pubdate dt-published",l.author=l.div.cloneNode(),l.author.className="webmention__author p-author h-card",l.author_name.className="p-name",l.author_link=l.a.cloneNode(),l.author_link.className="u-url",l.photo.className="webmention__author__photo u-photo",l.photo.alt="",l.title=l.div.cloneNode(),l.title.className="webmention__title p-name",l.permalink=l.a.cloneNode(),l.permalink.className="webmention__source u-url",l.permalink.appendChild(t.createTextNode("Permalink")),l.content=l.div.cloneNode(),l.content.className="webmention__content p-content",l.meta=l.div.cloneNode(),l.meta.className="webmention__meta",e.AG.processWebmentions=function(e){!e||"error"in e||(e.links.reverse(),e.links.forEach(N),f())},"preconnect"in e.AG&&(e.AG.preconnect("//webmention.io"),e.AG.preconnect("ws://webmention.io:8080")),(n=t.createElement("script")).async=!0,n.src="//webmention.io/api/mentions?jsonp=window.AG.processWebmentions&target[]="+c.join("&target[]="),t.getElementsByTagName("head")[0].appendChild(n),i.length&&"WebSocket"in e){var b=new WebSocket("ws://webmention.io:8080");b.onopen=function(){b.send(e.location)},b.onmessage=function(e){N(JSON.parse(e.data)),f()}}}function N(e){var n=!("data"in e),o=n?e:e.data,c=n?e.element_id:e.id,d=!1,p=!1;if(c=c.toString(),o.url&&o.url.indexOf("twitter.com/")>-1&&(d=!0,-1==o.url.indexOf("#favorited-by")&&(c=o.url.replace(/^.*?status\/(.*)$/,"$1"))),!(m.indexOf(c)>-1)){o.url.indexOf("/googleplus/")&&(p=!0);var u,h,b,N=l.li.cloneNode(!0),f=l.article.cloneNode(!0),_=l.author.cloneNode(!0),g=l.author_name.cloneNode(!0),C=l.author_link.cloneNode(!0),y=l.photo.cloneNode(!0),x=l.meta.cloneNode(!0),v=l.time.cloneNode(!0),k=o.name,A=!1,T=o.content,S=o.url||e.source,O=e.activity.type,E=!!o.author&&o.author.name,q=!!o.author&&o.author.photo,G="";N.id="webmention-"+c,N.appendChild(f),(k||T)&&(E?(q?(y.src=q,C.appendChild(y)):f.className+=" webmention--no-photo",g.appendChild(t.createTextNode(E)),o.author.url?(C.href=o.author.url,C.appendChild(g),_.appendChild(C)):_.appendChild(g),f.appendChild(_)):f.className+=" webmention--no-author",O||(O=p?S.indexOf("/like/")>-1?"like":S.indexOf("/repost/")>-1?"repost":S.indexOf("/comment/")>-1?"reply":"link":"post"),k&&k.length>200&&(k=!1),"post"==O||"link"==O&&!d&&!p?(A=k,!k&&S&&w(S,function(e){e&&linkTitle(N,S,e)})):"like"!=O&&"repost"!=O||(A="like"==O&&d?E+" favorited this.":"repost"==O&&d?E+" retweeted this.":k,f.className+=" webmention--author-starts"),o.published_ts?(b=new Date(0)).setUTCSeconds(o.published_ts):(o.published||e.verified_date)&&(b=new Date(o.published||e.verified_date)),b&&(v.setAttribute("datetime",b.toISOString()),G+=b.getUTCDate()+" ",G+=r[b.getUTCMonth()]+" ",G+=b.getUTCFullYear(),v.appendChild(t.createTextNode(G)),x.appendChild(v)),A||(b&&S&&x.appendChild(t.createTextNode(" | ")),S&&((h=l.permalink.cloneNode(!0)).href=S,x.appendChild(h))),E&&-1==f.className.indexOf("webmention--author-starts")&&(k&&"0"==k.indexOf(E)||T&&"0"==T.indexOf(E))&&(f.className+=" webmention--author-starts"),A?(f.className+=" webmention--title-only",A=A.replace("reposts","reposted"),S?((h=l.a.cloneNode(!0)).href=S,h.appendChild(t.createTextNode(A))):h=t.createTextNode(A),(u=l.title.cloneNode(!0)).appendChild(h),f.appendChild(a.cloneNode(!0)),f.appendChild(u)):(f.className+=" webmention--content-only",(u=l.content.cloneNode(!0)).innerHTML=T,f.appendChild(u)),x.children.length>0&&f.appendChild(x),s&&(s.parentNode.replaceChild(i,s),s=!1),i.appendChild(N),m.push(c),N=null,f=null,_=null,g=null,C=null,y=null,u=null,h=null,x=null,v=null)}}function f(){var e=t.querySelector(".entry__jump--webmentions a"),n=t.querySelectorAll(".webmentions__item").length;e.innerHTML=n+" webmentions"}function w(t,n){if("XMLHttpRequest"in e){var o=new XMLHttpRequest;w=function(e,t){var n=!1;e="//whateverorigin.org/get?url="+encodeURIComponent(e),o.onreadystatechange=function(){4!=this.readyState||n||(n=!0,t(o.responseText))},xhr.onabort=function(){n||(n=!0,t(!1))},o.onerror=o.onabort,o.open("GET",e),o.send(null)}}else w=function(e,t){t(!1)};return w(t,n)}}(this,this.document);