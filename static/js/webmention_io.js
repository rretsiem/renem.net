!function(e,t){"use strict";function n(e){var n=!("data"in e),o=n?e:e.data,l=n?e.element_id:e.id,a=!1,p=!1;if(l=l.toString(),o.url&&o.url.indexOf("twitter.com/")>-1&&(a=!0,-1==o.url.indexOf("#favorited-by")&&(l=o.url.replace(/^.*?status\/(.*)$/,"$1"))),!(N.indexOf(l)>-1)){o.url.indexOf("/googleplus/")&&(p=!0);var m,h,b,f=c.li.cloneNode(!0),w=c.article.cloneNode(!0),_=c.author.cloneNode(!0),g=c.author_name.cloneNode(!0),C=c.author_link.cloneNode(!0),y=c.photo.cloneNode(!0),x=c.meta.cloneNode(!0),v=c.time.cloneNode(!0),k=o.name,A=!1,T=o.content,S=o.url||e.source,O=e.activity.type,E=!!o.author&&o.author.name,q=!!o.author&&o.author.photo,G="";f.id="webmention-"+l,f.appendChild(w),(k||T)&&(E?(q?(y.src=q,C.appendChild(y)):w.className+=" webmention--no-photo",g.appendChild(t.createTextNode(E)),o.author.url?(C.href=o.author.url,C.appendChild(g),_.appendChild(C)):_.appendChild(g),w.appendChild(_)):w.className+=" webmention--no-author",O||(O=p?S.indexOf("/like/")>-1?"like":S.indexOf("/repost/")>-1?"repost":S.indexOf("/comment/")>-1?"reply":"link":"post"),k&&k.length>200&&(k=!1),"post"==O||"link"==O&&!a&&!p?(A=k,!k&&S&&i(S,function(e){e&&linkTitle(f,S,e)})):"like"!=O&&"repost"!=O||(A="like"==O&&a?E+" favorited this.":"repost"==O&&a?E+" retweeted this.":k,w.className+=" webmention--author-starts"),o.published_ts?(b=new Date(0)).setUTCSeconds(o.published_ts):(o.published||e.verified_date)&&(b=new Date(o.published||e.verified_date)),b&&(v.setAttribute("datetime",b.toISOString()),G+=b.getUTCDate()+" ",G+=d[b.getUTCMonth()]+" ",G+=b.getUTCFullYear(),v.appendChild(t.createTextNode(G)),x.appendChild(v)),A||(b&&S&&x.appendChild(t.createTextNode(" | ")),S&&((h=c.permalink.cloneNode(!0)).href=S,x.appendChild(h))),E&&-1==w.className.indexOf("webmention--author-starts")&&(k&&"0"==k.indexOf(E)||T&&"0"==T.indexOf(E))&&(w.className+=" webmention--author-starts"),A?(w.className+=" webmention--title-only",A=A.replace("reposts","reposted"),S?((h=c.a.cloneNode(!0)).href=S,h.appendChild(t.createTextNode(A))):h=t.createTextNode(A),(m=c.title.cloneNode(!0)).appendChild(h),w.appendChild(s.cloneNode(!0)),w.appendChild(m)):(w.className+=" webmention--content-only",(m=c.content.cloneNode(!0)).innerHTML=T,w.appendChild(m)),x.children.length>0&&w.appendChild(x),u&&(u.parentNode.replaceChild(r,u),u=!1),r.appendChild(f),N.push(l),f=null,w=null,_=null,g=null,C=null,y=null,m=null,h=null,x=null,v=null)}}function o(){var e=t.querySelector(".entry__jump--webmentions a"),n=t.querySelectorAll(".webmentions__item").length;e.innerHTML=n+" webmentions"}function i(t,n){if("XMLHttpRequest"in e){var o=new XMLHttpRequest;i=function(e,t){var n=!1;e="//whateverorigin.org/get?url="+encodeURIComponent(e),o.onreadystatechange=function(){4!=this.readyState||n||(n=!0,t(o.responseText))},xhr.onabort=function(){n||(n=!0,t(!1))},o.onerror=o.onabort,o.open("GET",e),o.send(null)}}else i=function(e,t){t(!1)};return i(t,n)}if("querySelectorAll"in t){"AG"in e||(e.AG={}),e.location.origin||(e.location.origin=e.location.protocol+"//"+e.location.host);var l,a,r=t.querySelectorAll(".webmentions__list"),c={a:t.createElement("a"),author_name:t.createElement("b"),article:t.createElement("article"),div:t.createElement("div"),photo:t.createElement("img"),li:t.createElement("li"),time:t.createElement("time")},s=t.createTextNode(" "),d=["January","February","March","April","May","June","July","August","September","October","November","December"],p=[],u=!1,m=t.querySelector('meta[property="webmention:redirected_from"]'),h=[],b=e.location.origin,N=[],f=0;if(m&&(m.getAttribute("content").split(",").forEach(function(e){p.push(e.indexOf("//")<0?b+e:e)}),!1),"http:"!=e.location.protocol&&(p.forEach(function(e){h.push(e),-1!=e.indexOf("https://")&&h.push(e.replace("https://","http://"))}),p=h,h=!1),r.length<1){if(!(u=t.querySelectorAll(".webmentions__not-found")).length)return;u=u[0],(r=t.createElement("ol")).className="webmentions__list"}else{for(f=(a=(r=r[0]).querySelectorAll("[id^=webmention-]")).length;f--;)N.push(a[f].getAttribute("id").replace("webmention-",""));a=null}if(e.AG.existing_webmentions=N,c.li.className="webmentions__item",c.article.className="h-cite webmention",c.time.className="webmention__pubdate dt-published",c.author=c.div.cloneNode(),c.author.className="webmention__author p-author h-card",c.author_name.className="p-name",c.author_link=c.a.cloneNode(),c.author_link.className="u-url",c.photo.className="webmention__author__photo u-photo",c.photo.alt="",c.title=c.div.cloneNode(),c.title.className="webmention__title p-name",c.permalink=c.a.cloneNode(),c.permalink.className="webmention__source u-url",c.permalink.appendChild(t.createTextNode("Permalink")),c.content=c.div.cloneNode(),c.content.className="webmention__content p-content",c.meta=c.div.cloneNode(),c.meta.className="webmention__meta",e.AG.processWebmentions=function(e){!e||"error"in e||(e.links.reverse(),e.links.forEach(n),o())},"preconnect"in e.AG&&(e.AG.preconnect("//webmention.io"),e.AG.preconnect("ws://webmention.io:8080")),l=t.createElement("script"),l.async=!0,l.src="//webmention.io/api/mentions?jsonp=window.AG.processWebmentions&target[]="+p.join("&target[]="),t.getElementsByTagName("head")[0].appendChild(l),r.length&&"WebSocket"in e){var w=new WebSocket("ws://webmention.io:8080");w.onopen=function(){w.send(e.location)},w.onmessage=function(e){n(JSON.parse(e.data)),o()}}}}(this,this.document);